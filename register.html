<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>CODE:YOU ç™»éŒ²ãƒšãƒ¼ã‚¸</title>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAbprOKaVJO91Wi81oU4mATpnVzMdPUcds",
      authDomain: "codeyou-d.firebaseapp.com",
      projectId: "codeyou-d",
      storageBucket: "codeyou-d.appspot.com",
      messagingSenderId: "734412845111",
      appId: "1:734412845111:web:82b7cda6543a4def9bcfb2",
      measurementId: "G-2DMVY9S7NM"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    async function registerLink(event) {
      event.preventDefault();
      const id = document.getElementById("id").value.trim();
      const url = document.getElementById("url").value.trim();

      if (!id || !url) {
        alert("IDã¨URLã®ä¸¡æ–¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");
        return;
      }

try {
  await setDoc(doc(db, "redirects", id), {
    url: url
  });

  // æˆåŠŸã—ãŸã¨ãã®è¦‹ãŸç›®å¤‰æ›´
  document.body.innerHTML = `
  <h1>ğŸ‰ ç™»éŒ²å®Œäº†ï¼</h1>
  <p>QRã‚³ãƒ¼ãƒ‰ã‚’èª­ã¿å–ã‚‹ã¨ã€ã‚ãªãŸã®è¨­å®šã—ãŸãƒªãƒ³ã‚¯ã«é£›ã¶ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚</p>
  <p><strong>ID:</strong> <code>${id}</code></p>
  <p><strong>ãƒªãƒ³ã‚¯:</strong> <a href="${url}" target="_blank"><code>${url}</code></a></p>
  <br>
  <p>ã‚‚ã†ä¸€åº¦ç™»éŒ²ã—ãŸã„å ´åˆã¯ã€ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¦ãã ã•ã„ã€‚</p>
`;
} catch (error) {
  console.error("ç™»éŒ²ã‚¨ãƒ©ãƒ¼:", error);
  alert("ç™»éŒ²ã«å¤±æ•—ã—ã¾ã—ãŸã€‚");
}
      
    }
  </script>
</head>
<body>
  <h1>CODE:YOU ç™»éŒ²ãƒšãƒ¼ã‚¸</h1>
  <p>æœã«è¨˜è¼‰ã•ã‚ŒãŸIDã€ã¾ãŸã¯è‡ªåˆ†ã§è‡ªç”±ã«æ±ºã‚ãŸIDã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</p>
  <p style="font-size: 0.9em; color: gray;">
    â€» ã“ã®IDã¯ã€ä»–ã®äººãŒQRã‚’èª­ã¿å–ã£ãŸã¨ãã«ã‚ãªãŸã®SNSãªã©ã«é£›ã¶â€œåå‰â€ã«ãªã‚Šã¾ã™ã€‚
  </p>

  <form onsubmit="registerLink(event)">
    <label for="id">IDï¼ˆè‹±æ•°å­—ãƒ»è‡ªç”±ã«æ±ºã‚ã¦OKï¼‰:</label><br>
    <input type="text" id="id" name="id" placeholder="ä¾‹: yourname123" required><br><br>

    <label for="url">ãƒªãƒ³ã‚¯å…ˆURLï¼ˆInstagramãªã©ï¼‰:</label><br>
    <input type="url" id="url" name="url" placeholder="https://example.com/yourpage" required><br><br>

    <button type="submit">ç™»éŒ²ã™ã‚‹</button>
  </form>
</body>
</html>
